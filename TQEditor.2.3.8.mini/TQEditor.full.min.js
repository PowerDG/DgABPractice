(function(e,j){if(e.TQE)return;var v="2.3.1 mini",q=navigator.userAgent.toLowerCase(),b=e.document,f=!!e.ActiveXObject,g=f&&!e.XMLHttpRequest,w=f&&!!b.createDocumentFragment,n=q.indexOf("webkit")>=0,m=q.indexOf("presto")>=0,l=!n&&!m&&q.indexOf("gecko")>=0,I="\u6dfb\u52a0\u94fe\u63a5",r='<option value="">\u9ed8\u8ba4</option><option value="_blank">\u65b0\u7a97\u53e3</option><option value="_self">\u5f53\u524d\u7a97\u53e3</option><option value="_parent">\u7236\u7a97\u53e3</option><option value="_top">\u9876\u5c42\u7a97\u53e3</option>',C='\u7f51\u5740:<input type="text" id="url" value="" size=45 /><br />\u6807\u9898:<input type="text" id="title" value="" size=45 /><br />\u6253\u5f00:<select id="target">'+r+"</select>",F="\u63d2\u5165\u56fe\u7247",z='\u56fe\u7247\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u66ff\u6362\u6587\u672c:<input name="alt" type="text" id="alt" size="20" /><br />\u5c3a\u5bf8:<input name="width" type="text" id="width" size="4" /> &times; <input name="height" type="text" id="height" size="4" /> px &nbsp;<br />\u5bf9\u9f50:<select name="align" id="align"><option value="" >\u9ed8\u8ba4</option><option value="top">\u5c45\u4e0a</option><option value="textTop">\u6587\u672c\u4e0a\u65b9</option><option value="middle">\u5c45\u4e2d</option><option value="absMiddle">\u7edd\u5bf9\u5c45\u4e2d</option><option value="baseline">\u57fa\u7ebf</option><option value="bottom">\u5e95\u90e8</option><option value="absBottom">\u7edd\u5bf9\u5e95\u90e8</option><option value="left">\u5de6</option><option value="right">\u53f3</option></select> &nbsp; &nbsp; \u8fb9\u6846:<input name="border" type="text" id="border" size="5" />',x='<form class="ePopForm">\u7f51\u5740: <input type="text" id="url" size="50"><br>\u5c3a\u5bf8: <input  type="text" id="width" style="width:30px; overflow:visible;"> &times; <input  type="text" id="height" style="width:30px; overflow:visible;">px <a href="javascript:void(0)" id="resetWH" >\u91cd\u8bbe\u5927\u5c0f</a><label><input name="lock" type="checkbox" id="lock" value="1" checked>\u9501\u5b9a\u6bd4\u4f8b</label><br>\u66ff\u6362\u6587\u672c: <input type="text" id="alt" /> \u8fb9\u6846: <input type="text" id="border" style="width:30px; overflow:visible;" /><br>\u6392\u7248: <a href="javascript:void(0)" id="alignDefault">\u9ed8\u8ba4</a> | <a href="javascript:void(0)" id="alignLeft">\u5de6\u6d6e\u52a8</a> | <a href="javascript:void(0)" id="alignC">\u5c45\u4e2d</a> | <a href="javascript:void(0)" id="alignRight">\u53f3\u6d6e\u52a8</a> | <a href="javascript:void(0)" id="alignTop">\u4e0a\u5bf9\u9f50</a> | <a href="javascript:void(0)" id="alignAbsMiddle">\u4e2d\u5bf9\u9f50</a> | <a href="javascript:void(0)" id="alignBottom">\u4e0b\u5bf9\u9f50</a><div><hr>\u94fe\u63a5: <input type="text" id="link" size="40"><select id="target">'+r+"</select></div></form>",E="\u63d2\u5165\u52a8\u753b",y='Flash\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u5c3a\u5bf8:<input name="width" type="text" id="width" size="4" value="200" />&times;<input name="height" type="text" id="height" size="4" value="200" /> px',G="\u63d2\u5165\u97f3\u9891",A='\u97f3\u9891\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u81ea\u52a8\u64ad\u653e:<select id="auto_start" name="auto_start"><option value="0">\u624b\u52a8\u5f00\u59cb</option><option value="1">\u81ea\u52a8\u5f00\u59cb</option></select>',H="\u63d2\u5165\u89c6\u9891",B='\u89c6\u9891\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u5c3a\u5bf8:<input name="width" type="text" id="width" size="4"  value="320"/>&times;<input name="height" type="text" id="height" size="4" value="240" /> px<br />\u81ea\u52a8\u64ad\u653e:<select id="auto_start" name="auto_start"><option value="0">\u624b\u52a8\u5f00\u59cb</option><option value="1">\u81ea\u52a8\u5f00\u59cb</option></select><br />\u89c6\u9891\u7c7b\u578b:<select id="video_type" name="video_type"><option value="auto">\u81ea\u52a8\u8bc6\u522b</option><option value="flv">FLV</option><option value="rm">RMVB</option><option value="wm">\u5176\u4ed6\u89c6\u9891</option></select>',J="\u65e0\u8272",P="\u786e\u5b9a",M="\u53d6\u6d88",L="\u4e0a\u4f20",R="\u5173\u95ed",K="\u7248\u672c",Q="\u4f5c\u8005",O="\u5b98\u7f51",N="\u90ae\u7bb1",D="\u5206\u9875\u6807\u9898: ",a=function(t,o){var k=this,q=a.clone(a.config);k.objId=t;if(o){if(o.height&&o.height!="auto"){o.height=parseInt(o.height);if(isNaN(o.height))o.height="auto"}for(var u in o)q[u]=o[u]}if(typeof q.toolbar=="string"){var r=a.toolbarMode[q.toolbar];if(!r)r=a.toolbarMode.normal;q.toolbar=r.left;if(!o||j===o.toolbarRight)q.toolbarRight=r.right}k.config=q;k.hasFocus=false;k._containerDiv=null;k._toolbarDiv=null;k._clientDiv=null;k._statusDiv=null;k.init=function(){k.obj=a.find(k.objId);if(!k.obj){if(k.config.debug)throw"\u7f3a\u5c11ID\u4e3a "+k.objId+" \u8868\u5355\u5143\u7d20";return}if(k.obj.editor)return;k.obj.editor=k;if(!k.config.width||k.config.width=="auto")if(k.obj.style.width)k.config.width=k.obj.style.width;else if(k.obj.cols)k.config.width=k.obj.cols*8+"px";else k.config.width="100%";if(!k.config.height||k.config.height=="auto")if(k.obj.style.height)k.config.height=parseInt(k.obj.style.height,10);else if(k.obj.offsetHeight)k.config.height=k.obj.offsetHeight;else if(k.obj.rows)k.config.height=k.obj.rows*17;else k.config.height=200;var i,j,h,d='<div class="" id="'+k.objId+'_EditorToolBar">';d+='</div><div id="'+k.objId+'_EditorClient" class="eEditorClient"><iframe id="'+k.objId+'_Editor" style="height:'+k.config.height+'px;" frameborder=0 ></iframe></div><div class="eStatusBar"><div class="eResizeWH" ></div><div class="eResizeH" ></div></div>';if(!k.config.debug)k.obj.style.display="none";var c=a.CE("DIV","TQEditorContainer_"+k.objId,d);c.className="eEditor";c.style.width=k.config.width;k.obj.parentNode.insertBefore(c,k.obj);k._containerDiv=c;k._toolbarDiv=a.find(k.objId+"_EditorToolBar");k._clientDiv=a.find(k.objId+"_EditorClient");"function"===typeof k.config.oninit&&k.config.oninit.call(k);k._initContent(k.obj.value);k.changeToolbarMode(k.config.advToolbarMode,true);k.obj.focus=function(){this.editor.focus()};k._statusDiv=c.lastChild;if(false==k.config.resize)k._statusDiv.style.display="none";k._statusDiv.onmousedown=function(h){var m,o,l,d,i=this,c=a.pos(this),q=a._docST(),p=a._docSL(),r=k.config.height,s=k._containerDiv.offsetWidth-2,j=this.style.cursor=="se-resize",v=a.pos(k._clientDiv).y,t=b.onmousemove,u=b.onmouseup;if(f){h=e.event;l=h.srcElement;m=p+h.clientX-c.x;o=q+h.clientY-c.y}else{l=h.target;m=h.pageX-c.x;o=h.pageY-c.y}j=j||l===i.firstChild&&"h"!=k.config.resize;i.mouseout=i.onmouseleave=null;if(n||g){d=a.CE("DIV","","",true);d.className="eDragMaskDiv";d.style.cursor=j?"se-resize":"s-resize";d.style.height=Math.max(b.documentElement.clientHeight,b.body.scrollHeight)+"px"}if(i.setCapture)i.setCapture();else e.captureEvents&&e.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);b.onmousemove=function(b){if(f){b=e.event;b.pageX=p+b.clientX;b.pageY=q+b.clientY}var d=v-a.pos(k._clientDiv).y,h=Math.max(50-r+c.y-d,b.pageY-o),g=Math.max(100-s+c.x,b.pageX-m);j&&k.setWidth(g-c.x+s);k.setHeight(h-c.y+r+d)};b.onmouseup=function(){if(i.releaseCapture)i.releaseCapture();else e.releaseEvents&&e.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);b.onmousemove=t;b.onmouseup=u;d&&b.body.removeChild(d);d=null;k.focus()}}};k._toobarCode=function(f,d){var c,e,b="";if(d.length){b+='<span class="eToolBarGroupRight" >';for(c=0;c<d.length;c++)b+=k._btnCode(d[c],false);b+="</span>"}b+='<span class="eToolBarGroup" >';if(k.config.showToolbarGroupHandle){e=a.toolbarBottons.group;b+='<div class="eButton eFirstToolBarGroup" id="eBTNgroup"  style="background-position: -'+e.left+"px 0;width:"+e.width+'px;" ></div>'}for(c=0;c<f.length;c++)b+=k._btnCode(f[c],true);b+='</span><div class="eClear"></div>';return b};k._btnCode=function(b,g){var f="",c,e,d;if("||"===b)b="group";else if("|"===b)b="separator";else if("string"!==typeof b){f='submenu="'+b.join(",")+'" ';b="submenu"}c=a.toolbarBottons[b];if(!c)return"";d=function(a){return'id="eBTN'+b+'" class="eButton"'+(a.css?' style="'+a.css+'"':"")};switch(b){case"group":if(!g)return"";e='</span><span class="eToolBarGroup" >';if(k.config.showToolbarGroupHandle)e+="<div "+d(c)+" ></div>";return e;case"separator":return"<div "+d(c)+" ></div>";case"br":return"<br />";default:return'<a href="javascript:void(0)" name="'+b+'" title="'+c.text+'" '+f+d(c)+" >"+c.text+"</a>"}};k._ieMouseStyle=function(c,e,d,h){if(!f||!g&&b.compatMode=="CSS1Compat")return;a.addListener(c,"mouseover",function(){this.className=d});a.addListener(c,"mouseup",function(){this.className=d});a.addListener(c,"mousedown",function(){this.className=h});a.addListener(c,"mouseout",function(){this.className=e})};k._keepBookmark=function(){if(f){var b,c=a.find(k.objId+"_Editor");a.addListener(c,"beforedeactivate",function(){b=k._getRange()});a.addListener(c,"activate",function(){if(null==b)return;var a=k._getSelection();if(a.addRange)a.addRange(b);else b.select();b=null})}};k._toolbarBottonClick=function(){var d=f?event:arguments[0],c=this.getAttribute("name"),b=a.toolbarBottons[c];d.cancelBubble=true;k.focus();if(b&&b.click)b.click(k,this);else{a.hidePop();k.exeCmd(c)}};k.__selectOption=function(b,c){for(var a=b.options.length-1;a>=0;a--)if(b.options[a].value==c){b.selectedIndex=a;return}};k.exeCmd=function(b,a){k.focus();var c=k._getDoc(),e=k._getSelection(),g,h,d;try{return c.execCommand(b,false,a!=null?a:false)}catch(f){}};k.focus=function(){if(k.hasFocus)return;if("visual"==k.currentMode()){k._editorObj().contentWindow.focus();var b=k._getRange(),a=k._getSelection();if(n&&a.rangeCount<1){b.selectNodeContents(k._getDoc().body);b.collapse(true);a.removeAllRanges();a.addRange(b)}}else k._editorObj().focus();k.hasFocus=true};k.focusNode=function(){if("visual"!==k.currentMode()||!k.hasFocus)return null;var a,b=k._getSelection().focusNode;if(!b){a=k._getRange();return a.length?a.item(0).parentNode:a.parentElement?a.parentElement():null}return b};k._showColorSelectUI=function(d,c){var b=a.find(k.objId+"ColorSelect"+c);if(null==b){b=a.CE("DIV",k.objId+"ColorSelect"+c,a._colorPickerUI(),true);b.className="ePopPanel";a._noSel(b);a.listenTags(b,"TD","click",function(){a.hidePop();k.exeCmd(c,this.bgColor)});b.lastChild.lastChild.onclick=function(){a.hidePop();k.exeCmd(c,"")};a.listenTags(b,"TD","mouseover",function(){var a=this,c=e.setInterval(function(){a.style.backgroundColor=a.style.backgroundColor!=""?"":"#FFFFFF"},500),b=this.parentNode.parentNode.parentNode.parentNode.lastChild;b.firstChild.style.backgroundColor=this.bgColor;b.firstChild.nextSibling.innerHTML=this.bgColor;this.style.backgroundColor="#FFFFFF";this.onmouseout=function(){e.clearInterval(c);this.style.backgroundColor=""}})}a.pop(b,d)};k._popAsMenu=function(i,j){var l=i.getAttribute("name"),b=a.find(k.objId+"PopMenu"+l),h="",f,c,d,e;if(null==b){b=a.CE("DIV",k.objId+"PopMenu"+l,"",true);b.className="ePopPanel"}for(c=0;c<j.length;c++){d=j[c];if("separator"==d||"|"==d){h+='<hr style="width:120px; clear:both;" />';continue}e=a.toolbarBottons[d];if(e)h+='<div  name="'+d+'" class="eMenuItem" ><span class="eButton" id="eBTN'+d+'" ></span>'+e.text+"</div>"}b.innerHTML=h;a._noSel(b);m&&a._noSel(b,"DIV");a.listenTags(b,"DIV","click",k._toolbarBottonClick);if(g){f=a._tags(b,"DIV");for(c=f.length-1;c>=0;c--)k._ieMouseStyle(f[c],"eMenuItem","eMenuItemUp","eMenuItem")}a.pop(b,i)};k._popFormUI=function(u,r,t,s,e,b,o,p,q){var c='<form class="ePopForm">';if(b){c+='<div class="eTabBar"><a href="javascript:void(0)" class="active" HIDEFOCUS="true">'+r+'</a><a href="javascript:void(0)" HIDEFOCUS="true">'+L+"</a></div>";c+="<div>"}c+=t;c+='<div class="eBar"><button id="OK" name="OK" type="submit" class="eBtn"  HIDEFOCUS="true"/>'+P+'</button> &nbsp; <button id="Cancel" name="Cancel" type="button" class="eBtn"  HIDEFOCUS="true">'+M+"</button></div>";if(b){c+='</div><div style="display:none">';var f=b;if(b.substr(0,1)=="#")f=b.substring(1);else{if(!("http://"==b.substr(0,7).toLowerCase()||"/"==b.substr(0,1)||"https://"==b.substr(0,6).toLowerCase()))if("?"==b.substr(0,1))b=location.pathname+b;else{var h=location.pathname.split("/");h[h.length-1]=b;b=h.join("/")}f=a.url+"upload.htm?url="+encodeURIComponent(b)+"&field_name="+k.config.uploadFieldName+"&exts="+encodeURIComponent(o)+"&max_size="+encodeURIComponent(p)+"&debug="+k.config.debug+"&upload_type="+q}c+='<iframe src="'+f+'" frameborder=0 width=358 height=45 ALLOWTRANSPARENCY=true marginwidth=0 marginheight=0 ></iframe>';c+="</div>"}c+="</form>";var d=a.CE("DIV",u,c,true);d.className="ePopPanel";if(b){var l=function(){this.className="active";var a=this.parentNode.nextSibling;if(this.nextSibling){this.nextSibling.className="";a.style.display="";a.nextSibling.style.display="none";a.parentNode.getElementsByTagName("INPUT")[0].focus()}else if(this.previousSibling){this.previousSibling.className="";a.style.display="none";a.nextSibling.style.display=""}},n=d.firstChild.firstChild;n.firstChild.onclick=l;n.lastChild.onclick=l}var j=a._tags(d,"FORM")[0],g=j.elements;j.srcEditor=k;g.Cancel.onclick=a.hidePop;g.OK.onclick=s;j.onsubmit=function(){this.elements.OK.click();return false};if(e)for(i=e.length-1;i>=0;i--)k._intEdit(g[e[i]]);a._noSel(d);m&&a._noSel(d,"FORM,DIV");return d};k.insertMusic=function(b,a){var c=k.config.tplMusic.replace(/\{\$url\}/g,b).replace(/\{\$auto_start\}/g,a);k.insertHtml(c)};k.insertFlash=function(d,c,b){var a=k.config.tplFlash.replace(/\{\$url\}/g,d);a=a.replace(/\{\$width\}/g,c);a=a.replace(/\{\$height\}/g,b);k.insertHtml(a)};k.insertVideo=function(c,d,g,f,e){var a="",b;switch(e){case"rm":a=k.config.tplRm;break;case"flv":a=k.config.tplFlv;break;case"wm":a=k.config.tplVideo;break;default:b=c.substr(c.lastIndexOf(".")).toLowerCase();if(".flv"==b)a=k.config.tplFlv;else if(".rm"==b||".rmvb"==b)a=k.config.tplRm;else a=k.config.tplVideo}a=a.replace(/\{\$url\}/g,c).replace(/\{\$auto_start\}/g,d).replace(/\{\$width\}/g,g).replace(/\{\$height\}/g,f);k.insertHtml(a)};k.insertHtml=function(e,d){k.focus();if("code"==k.currentMode()){var f=k._editorObj();if(b.selection){var c=b.selection.createRange();if("before"==d||-1==d)c.text=e+c.text;else if("after"==d||1==d)c.text+=e;else c.text=e;c.select()}else if(f.selectionStart||f.selectionStart=="0"){var j=f.selectionStart,m=f.selectionEnd,p=f.scrollTop,h=f.value;if("before"==d||-1==d)e=h.substring(j,m)+e;else if("after"==d||1==d)e+=h.substring(j,m);f.value=h.substr(0,j)+e+h.substr(m,h.length);f.focus();f.selectionStart=f.selectionEnd=j+e.length;f.scrollTop=p}else{f.value+=e;f.focus()}k.save();return}if(l)e=e.replace(/<td([^>]*)>\s*<\/td/ig,"<td$1 ><br></td");var c=k._getRange();if(c.length){var q=k._getDoc(),r=c.item(0),i=q.body.createTextRange();i.moveToElementText(r);if("before"==d||-1==d)i.collapse();else if("after"==d||1==d)i.collapse(false);else c.execCommand("Delete");i.pasteHTML(e);i.select()}else if(c.insertNode){var g,o,n;if(c.createContextualFragment)g=c.createContextualFragment(e);else{g=k._getDoc().createDocumentFragment();g.appendChild(a.CE("div"));g.firstChild.outerHTML=e}if("before"==d||-1==d){o=g.lastChild;c.insertNode(g);c.setEndAfter(o)}else if("after"==d||1==d){c.collapse(false);c.insertNode(g)}else{c.deleteContents();c.insertNode(g)}c.collapse(false);n=k._getSelection();n.removeAllRanges();n.addRange(c)}else{if("before"==d||-1==d)c.collapse(true);else("after"==d||1==d)&&c.collapse(false);c.pasteHTML(e);c.collapse(false);c.select()}k.save()};k.appendHtml=function(a){k.setContent(k.content()+a)};k._editorObj=function(){return a.find(k.objId+"_Editor")};k.currentMode=function(){return k._editorObj().tagName.toUpperCase()==="IFRAME"?"visual":"code"};k._getDoc=function(){var a=k._editorObj();return a.contentDocument||a.contentWindow.document};k._getSelection=function(){var a=k._editorObj().contentWindow;return a.getSelection?a.getSelection():k._getDoc().selection};k._getRange=function(){var a=k._getSelection(),c=k._getDoc(),b;try{b=a.rangeCount>0?a.getRangeAt(0):a.createRange?a.createRange():c.createRange()}catch(d){}if(!b)b=f?c.body.createTextRange():c.createRange();return b};k.insertImage=function(g,c,b,d,f,e){if(""==g)return;var a='<img src="'+g+'" ';if(c!==j&&""!=c&&!isNaN(parseInt(c))&&parseInt(c)>0)a+=" width="+parseInt(c);if(b!==j&&""!=b&&!isNaN(parseInt(b))&&parseInt(b)>0)a+=" height="+parseInt(b);if(d!==j&&""!=d&&!isNaN(parseInt(d)))a+=" border="+parseInt(d);if(f!==j&&""!=f)a+=' alt="'+f+'"';if(e!==j&&""!=e)a+=' align="'+e+'"';a+=" />";k.insertHtml(a);return};k._enableButton=function(b,c){if(b.disabled===j)b.disabled=false;if(b.disabled!=c)return;if(c){b.disabled=false;k.setOpacity(b,100);a.addListener(b,"click",k._toolbarBottonClick)}else{b.disabled=true;k.setOpacity(b,30);a.delListener(b,"click",k._toolbarBottonClick)}};k._updateToolbar=function(g,f,e){var h=k._toolbarDiv,d=k._button("mode"),c=a._tags(h,"A"),b;if(d)d.id="visual"===k.currentMode()?"eBTNmode":"eBTNmode-reset";for(b=c.length-1;b>=0;b--)k.inArray(c[b].getAttribute("name"),f)^e&&k._enableButton(c[b],g)};k._hook=function(){var c=k._getDoc();c.onkeydown=function(g){a._hideContext();if(f)g=k._realEvent(g);var i=g.keyCode||g.which;g.ctrlKey&&(13==i||10==i||83==i)&&k.save();var o=k._call("keydown",g);if(j!==o&&false==o)return false;if(i==13){var c=k.focusNode(),m,h,e,n;if(!c)return;if(c.nodeName==="#text")c=c.parentNode;if(c.className=="splitPage"){m=c.parentNode;if(c.nextSibling&&c.nextSibling.nodeName==="BR")h=c.nextSibling;else{h=b.createElement("BR");if(m.lastChild==c)m.appendChild(h);else m.insertBefore(h,c.nextSibling)}n=k._getDoc();if(f){e=n.body.createTextRange();e.moveToElementText(h);e.collapse(true);e.select()}else{e=n.createRange();e.selectNode(h);e.collapse(true);var p=k._getSelection();p.removeAllRanges();p.addRange(e)}return false}if(k.config.enter2br){if(c.tagName!="LI"){k.insertHtml("<br />");return false}}else if(!f&&!g.shiftKey){for(var o=k._getRange(),d,l=o.startContainer;l;l=l.parentNode){d=l.nodeName;if(d=="LI"||d=="P"||"H1"==d||"H2"==d||"H3"==d||"H4"==d||"H5"==d||"H6"==d||"DIV"==d)return true}k.exeCmd("FormatBlock","p")}}};c.onkeyup=function(b){b=k._realEvent(b);var e=b.keyCode||b.which,d=this.body.firstChild;if((8===e||46===e)&&d&&d===c.body.lastChild){var a=d.nodeName,f=d.innerHTML,g=/^<(strong|em|b|i|u|font)[^>]*><\/\1>|&nbsp;$/i;if(a==="P"||a==="H1"||a==="H2"||a==="H3"||a==="H4"||a==="H5"||a==="H6"||a==="BR")if(""===f||g.test(f))c.body.innerHTML=""}k._call("keyup",b)};c.onclick=function(c){var b,e,d;a._hideContext();if(!f){b=c.target;if("IMG"===b.nodeName){e=k._getDoc().createRange();d=k._getSelection();e.selectNode(c.target);d.removeAllRanges();d.addRange(e);k._popImagePanel(b)}}else{c=k._realEvent(c);b=c.srcElement;"IMG"===b.nodeName&&k._popImagePanel(b)}};if(f){c.onmousedown=c.onclick;c.onclick=null}c.body.onpaste=function(a){if(f)a=k._realEvent(a);var b=k._call("paste",a);k.config.autoClean&&setTimeout(k.cleanWord,200)};a.addListener(c,"mouseup",a.hidePop);if(g){a.addListener(c,"mouseup",k.focus);a.addListener(c,"mousedown",k.focus)}};k._popImagePanel=function(c){if(!k.config.autoPopImagePanel)return;var b=a.find("__tqImagePanel");if(null==b){b=a.CE("DIV","__tqImagePanel",x,true);b.className="ePopPanel";var j=a._tags(b,"FORM")[0],d=j.elements;k._intEdit(d.width);k._intEdit(d.height);k._intEdit(d.border);b.urlField=d.url;b.widthField=d.width;b.heightField=d.height;b.lockField=d.lock;b.borderField=d.border;b.altField=d.alt;b.linkField=d.link;b.targetField=d.target;b.linkField.onchange=function(){var c=this.parentNode.parentNode.parentNode,b=c.target,a=b.parentNode;if(a.nodeName!=="A")return;a.setAttribute("href",this.value)};b.targetField.onchange=function(){var c=this.parentNode.parentNode.parentNode,b=c.target,a=b.parentNode;if(a.nodeName!=="A")return;a.setAttribute("target",this.options[this.selectedIndex].value)};b.urlField.onchange=function(){this.parentNode.parentNode.target.src=this.value};b.urlField.onfocus=function(){this.select()};var i=function(){var a=this.parentNode.parentNode,b=a.target,c=h=Math.max(1,this.value);if(a.lockField.checked)if(this.id=="width")h=a.heightField.value=Math.round(c/a.rate);else c=a.widthField.value=Math.round(h*a.rate);else if(this.id=="width")h=a.heightField.value;else c=a.widthField.value;b.width=c;b.height=h;b.style.width="";b.style.height=""};b.widthField.onchange=b.widthField.onblur=b.heightField.onchange=b.heightField.onblur=i;b.borderField.onchange=function(){var a=this.parentNode.parentNode.target;if(""===this.value)a.removeAttribute("border");else a.border=this.value};b.altField.onchange=function(){var a=this.parentNode.parentNode.target;if(""===this.value)a.removeAttribute("alt");else a.alt=this.value};b.lockField.onclick=function(){if(this.checked){var a=this.parentNode.parentNode.parentNode;a.rate=a.widthField.value/a.heightField.value}};for(var g=function(){var c=this.parentNode.parentNode,a=c.target,b=this.id;if("resetWH"==b){a.removeAttribute("width");a.removeAttribute("height");a.style.width="";a.style.height="";c.widthField.value=a.width;c.heightField.value=a.height;c.rate=a.width/a.height}else{a.align="";a.style.display="";a.style.margin="";k.exeCmd("justifynone");if("alignC"==b)k.exeCmd("justifycenter");else if("alignDefault"!=b)a.align=b.substring(5,20).toLowerCase()}return false},f=a._tags(b,"A"),e=f.length-1;e>=0;e--)f[e].onclick=g;a._noSel(b)}if(c.parentNode&&c.parentNode.nodeName==="A"){b.lastChild.lastChild.style.display="";b.linkField.value=c.parentNode.getAttribute("href");k.__selectOption(b.targetField,c.parentNode.getAttribute("target"))}else{b.lastChild.lastChild.style.display="none";b.linkField.value="";b.targetField.selectedIndex=0}b.target=c;b.urlField.value=c.getAttribute("src");b.widthField.value=c.width;b.heightField.value=c.height;b.borderField.value=c.border;b.altField.value=c.alt;b.rate=c.width>0&&c.height>0?c.width/c.height:1;k._popContext(b,c)};k._popContext=function(b,g){a.activeContext!=b&&a._hideContext();var f,c,e;p=a.pos(k._editorObj()),p2=g.getBoundingClientRect(),d=a._doc();b.style.display="block";f=Math.min(p.x+p2.left,a._docSL()+d.clientWidth-b.offsetWidth-5);c=Math.min(p.y+p.height,10+p.y+p2.bottom);e=a._docST()+d.clientHeight-b.offsetHeight-10;if(c>e)c=Math.max(p.y-b.offsetHeight,p.y+p2.top-b.offsetHeight-10);b.style.left=f+"px";b.style.top=c+"px";a.activeContext=b;a.drag(b)};k._pos=function(d){var e=0,f=0,g=d.getBoundingClientRect(),c=k._getDoc(),b=k._editorObj().contentWindow,a=c.compatMode!="CSS1Compat"?c.body:c.documentElement;e=g.left-a.clientLeft+(b.scrollX?b.scrollX:a.scrollLeft);f=g.top-a.clientTop+(b.scrollY?b.scrollY:a.scrollTop);return{x:e,y:f,left:e,top:f,width:d.offsetWidth,height:d.offsetHeight}};k._changed=function(){k._autoSave(1);var b;if("visual"===k.currentMode()){k._keepBookmark();k._hook();b=k._editorObj().contentWindow;if(g)b=b.document.body}else{b=k._editorObj();a.addListener(b,"mouseup",a.hidePop);b.onkeydown=function(a){return k._call("keydown",a)};b.onkeyup=function(a){return k._call("keyup",a)}}b.onfocus=function(a){k.hasFocus=true;k.obj.onfocus&&k.obj.onfocus();k._call("focus",a)};b.onblur=function(a){k.hasFocus=false;k.obj.onblur&&k.obj.onblur();k._call("blur",a)}};k._realEvent=function(a){if(f)a="code"===k.currentMode()?e.event:k._editorObj().contentWindow.event;return a};k._call=function(b,c){var a=k.config["on"+b];if("function"===typeof a)return a.call(k,k._realEvent(c))};k.changeMode=function(c){var e=k.currentMode();if(e===c)return;if(!c)c="code"!=e?"code":"visual";if(c==e)return;k.hasFocus=false;var i=k._editorObj(),f=i.offsetHeight,d,g="visual"===c;if("code"===c){f-=4;d='<table width=100% border=0 cellpadding=0 cellspacing=0><tr><td width=2></td><td><textarea id="'+k.objId+'_Editor" wrap="hard" style="height:'+f+'px"></textarea></td></tr></table>'}else if(g)d='<IFRAME id="'+k.objId+'_Editor" frameborder=0 marginheight=0 marginwidth=0 style="height:'+f+'px" ></IFRAME>';else return;k._autoSave(0);a._hideContext();var h=k.content();b.body.appendChild(k._clientDiv);k._clientDiv.innerHTML=d;k._containerDiv.insertBefore(k._clientDiv,k._containerDiv.lastChild);k._initContent(h);k._updateToolbar(g,["toolbarmode","mode","fullscreen","help"],true)};k.typeset=function(){if("visual"!=k.currentMode())return;var g=k._getDoc(),b,d,h,f,e,l;h=g.body.innerHTML;h=h.replace(/&nbsp;/gi," ").replace(/>\s+</gm,"> <").replace(/ +/gi," ").replace(/<div/gi,"<p").replace(/<\/div/gi,"</p");g.body.innerHTML=h;d=a._tags(g,"CENTER");for(i=d.length-1;i>=0;i--)a.removeNode(d[i],false);d=a._tags(g,"SPAN");for(i=d.length-1;i>=0;i--){b=d[i];l=b.style.fontWeight,c=b.style.color;if(""===b.innerHTML.replace(/<[a-z\/][^>]*>/gi,"")||l==""&&c==""){a.removeNode(b,false);continue}b.removeAttribute("style");b.className="";b.removeAttribute("class");b.style.fontWeight=l;b.style.color=c}d=a._tags(g,"H3");for(i=d.length-1;i>=0;i--)if(d[i].className==="splitPage")d[i].innerHTML=d[i].innerHTML.replace(/<\/?[a-zA-z][^>]*>/g,"");d=a._tags(g,"P");var n=/^(&nbsp;| ){3,}/;for(i=d.length-1;i>=0;i--){b=d[i];if(""==b.innerHTML.replace(/<[a-z\/][^>]*>/gi,"").replace(/( |\n|\r|\t|&nbsp;)/gi,"")){a.removeNode(b,false);continue}b.removeAttribute("style");b.className="";b.removeAttribute("class");if(n.test(b.innerHTML))b.align="center";else{b.removeAttribute("align");b.style.textIndent=k.config.typesetIndentParagraph?"2em":""}}d=a._tags(g,"A");for(i=d.length-1;i>=0;i--){b=d[i];if(""==b.innerHTML.replace(/<[a-z\/][^>]*>/gi,"").replace(/( |\n|\r|\t|&nbsp;)/gi,"")){a.removeNode(b,false);continue}b.removeAttribute("style");b.className="";b.removeAttribute("class")}var m=function(a){var b=a.nodeName,c=/^( |\n|\r|\t|&nbsp;)*$/gi;return b==="#text"?c.test(a.nodeValue):"BR"===b||"IMG"!==b&&""==a.innerHTML.replace(/<[a-z\/][^>]*>/gi,"").replace(/(\s|&nbsp;)/gmi,"")},j=function(c){var b,d;while(c&&c.tagName!="BODY"){b=c;while(b=b.nextSibling){if(m(b))continue;if(b.nodeName==="#text"){f=a.CE("CENTER","",b.nodeValue);c.parentNode.insertBefore(f,b);a.removeNode(b,true);return}else{if(b.tagName=="CENTER")return;if(b.tagName=="P")b.align="center";else b.style.textAlign="center";return}}c=c.parentNode}};d=a._tags(g,"IMG");for(i=d.length-1;i>=0;i--){b=d[i];if(b.getAttribute("emot"))continue;k.config.typesetImageTextCenter&&j(b);b.removeAttribute("style");b.border=k.config.typesetImageBorder?"1":"0";b.style.margin="5px";e=b.parentNode;if(e.tagName=="A"&&e.firstChild==e.lastChild){b=e;e=e.parentNode}if(e.tagName=="P"&&e.align=="center"||e.tagName=="CENTER"||e.style.textAlign=="center")continue;f=a.CE("CENTER");e.insertBefore(f,b);f.appendChild(b)}d=a._tags(g,"OBJECT");for(i=d.length-1;i>=0;i--){b=d[i];k.config.typesetImageTextCenter&&j(b);e=b.parentNode;if(e.tagName=="P"&&e.align=="center"||e.tagName=="CENTER"||e.style.textAlign=="center")continue;f=a.CE("CENTER");e.insertBefore(f,b);f.appendChild(b)}d=a._tags(g,"EMBED");for(i=d.length-1;i>=0;i--){b=d[i];if("OBJECT"===b.parentNode.tagName)continue;k.config.typesetImageTextCenter&&j(b);e=b.parentNode;if(e.tagName=="P"&&e.align=="center"||e.tagName=="CENTER"||e.style.textAlign=="center")continue;f=a.CE("CENTER");e.insertBefore(f,b);f.appendChild(b)}k.cleanWord(true)};k.cleanWord=function(e){if("visual"!=k.currentMode())return;var b=k._getDoc(),c;if(!e){c=b.body.innerHTML;if(c.indexOf("mso")<0&&c.search(/[a-z]+:[a-z0-9]+="[^"]*"/ig)<0)return}var d=function(i,h){for(var d,f,c,e,g=i.length-1;g>=0;g--){f=a._tags(b,i[g]);for(e=f.length-1;e>=0;e--){d=f[e];d.removeAttribute("lang");c=d.getAttribute("style");if(null==c&&h){a.removeNode(d,false);continue}if(typeof c=="string"&&c.indexOf("mso-")>=0){c+=";";c=c.replace(/mso\-[^;]+?;/gi,"").replace(/FONT\-FAMILY[^;]+?;/gi,"").replace(/\s+/g," ").replace(/MARGIN\: 0cm 0cm 0pt/gi,"");if(""==c||" "==c){if(h){a.removeNode(d,false);continue}d.removeAttribute("style")}else d.setAttribute("style",c)}c=d.getAttribute("class");if(null!=c){c=c.replace(/mso[a-z\-]+\s*/gi,"");if(""==c)d.removeAttribute("class");else d.setAttribute("class",c)}}}};d(["SPAN"],true);d(["P","B","I","U","TD","TR","TABLE","DIV"],false);b.body.innerHTML=b.body.innerHTML.replace(/<o:[a-z0-9_]+[^>]*>/gi,"").replace(/<\/o:[a-z0-9_]+>/gi,"").replace(/<\?xml.+?\/>/gi,"").replace(/(<[a-z]+[^>]+>)/ig,function(b,a){if(a.indexOf(":")>0)a=a.replace(/[a-z]+:[a-z0-9]+="[^"]*"/ig,"");return a});k.save()};k.setWidth=function(a){if(a>1)k.config.width=a+"px";else k.config.width=a*100+"%";k._containerDiv.style.width=k.config.width};k.setHeight=function(a){if(a<9)a=9;k.config.height=a;k._setHeight(a)};k._setHeight=function(a){if(a<2)a=2;k._editorObj().style.height=a+"px";if("visual"==k.currentMode()){a-=6;if(a<2)a=2;k._getDoc().body.style.minHeight=a+"px";if(g)k._getDoc().body.style.height=a+"px"}};k._fixFull=function(){var c=a._doc(),b=k._containerDiv,d;b.style.zIndex="10000";b.style.width=c.clientWidth-2+"px";b.style.top=a._docST()+"px";b.style.left=a._docSL()+"px";d=c.clientHeight-k._toolbarDiv.offsetHeight;k._setHeight(d-("visual"==k.currentMode()?2:6))};k._button=function(d){for(var c=a._tags(k._toolbarDiv,"A"),b=c.length-1;b>=0;b--)if(d==c[b].getAttribute("name"))return c[b];return null};k.changeToolbarMode=function(e,l){var c=k._toolbarDiv,h,d,m=c.offsetHeight;if(e===j||null===e)e=c.className=="eToolBar"?true:false;else if(l===j||!l)if(e==(c.className!="eToolBar"))return;if(e){c.className="eToolBar eLargeIcons";b.body.appendChild(c);c.innerHTML=k._toobarCode(k.config.advToolbar,k.config.advToolbarRight);k._containerDiv.insertBefore(c,k._containerDiv.firstChild)}else{c.className="eToolBar";b.body.appendChild(c);c.innerHTML=k._toobarCode(k.config.toolbar,k.config.toolbarRight);k._containerDiv.insertBefore(c,k._containerDiv.firstChild)}if(g||f&&(b.documentMode==7||b.compatMode!="CSS1Compat")){var i=a._tags(c,"SPAN"),n;for(d=i.length-1;d>=0;d--)i[d].style.width=i[d].offsetWidth+"px"}if(m){k.setHeight(k.config.height+m-c.offsetHeight);k._containerDiv.style.position=="absolute"&&k._fixFull()}a._noSel(c);h=a._tags(c,"A");for(d=h.length-1;d>=0;d--){a.addListener(h[d],"click",k._toolbarBottonClick);a.addListener(h[d],"mouseout",function(){var b=a.activePop;this.className=b&&b.relateObj==this?"eButtonDropDown":"eButton"})}k._updateToolbar("visual"===k.currentMode(),["toolbarmode","mode","fullscreen","help"],true)};k.fullScreen=function(d){var c=k._containerDiv,f="visual"===k.currentMode(),h,g;if(d===j||null===d)d=c.style.position!="absolute";else if(d==(c.style.position=="absolute"))return;f&&k.changeMode("code");if(d){b.body.parentNode.style.overflow="hidden";b.body.appendChild(c);if(f)if(l)e.setTimeout(function(){k.changeMode("visual")},1);else k.changeMode("visual");c.style.position="absolute";c.style.top="0px";k._fixFull();a.addListener(e,"resize",k._fixFull)}else{b.body.parentNode.style.overflow="auto";a.delListener(e,"resize",k._fixFull);c.style.position="";c.style.width=k.config.width;h=k._editorObj();h.style.height=k.config.height+"px";k.obj.parentNode.insertBefore(c,k.obj);f&&k.changeMode("visual");c.scrollIntoView(false)}g=k._button("fullscreen");if(g)g.id=d?"eBTNfullscreen-reset":"eBTNfullscreen"};k.setContent=function(a){if("code"===k.currentMode())k._editorObj().value=a;else{if("function"===typeof k.config.onsetcontent)a=k.config.onsetcontent.call(k,a);k._getDoc().body.innerHTML=a}k.save()};k._initContent=function(b){if("code"!==k.currentMode()){if((l||m)&&"<br>"==b.substring(0,4))b=b.substr(4);if(l)b=b.replace(/<td([^>]*)>\s*<\/td/ig,"<td$1 ><br></td");var a=g?"":"<!DOCTYPE html>",c=k._getDoc(),d;a+="<html><head><style>\nbody{border:none;height:100%;margin:0;padding:2px;overflow:auto;";if(k.config.bgColor||k.config.textColor){if(k.config.bgColor)a+="background-color:"+k.config.bgColor+";";if(k.config.textColor)a+="color:"+k.config.textColor+";"}a+='}\nimg{cursor:default;}\n.selectedTD{background:#3399ff !important;}\n.splitPage{display:block;width:98%;!important;border-top:#999 1px solid;border-bottom:#999 1px solid;background:#FFFFFF; color:#000000;font-weight:bold;text-align:center;margin:30px auto 5;padding-top:30px;clear:both;}\n.splitPage:before{content:"'+D+'";}';if(k.config.cssCode)a+=k.config.cssCode;a+="</style>\n";if(k.config.baseHref!="")a+='<base href="'+k.config.baseHref+'" />';if(k.config.css)a+='<link href="'+k.config.css+'" rel="stylesheet" type="text/css">\n';a+='</head><body contenteditable="true" >'+b+"</body></html>";c.open();c.write(a);c.close();d=Math.max(20,k._editorObj().offsetHeight-6);if(c.body){c.body.style.minHeight=d+"px";if(g)c.body.style.height=d+"px"}}k.setContent(b);k._changed()};k.setOpacity=function(b,a){if(f)b.style.filter=a==100?"":"gray() alpha(opacity="+a+")";else b.style.opacity=a==100?"":a/100};k.inArray=function(c,b){for(var a=b.length-1;a>=0;a--)if(c==b[a])return true;return false};k.content=function(){var c=k.currentMode(),d,b;if("visual"===c){b=k._getDoc().body.innerHTML;if((l||m)&&"<br>"==b.substring(0,4))b=b.substr(4);if(""==b.replace(/<\/?(div|p|font|b|s|u|i|strong|em|strike)(?![a-z0-9])[^>]*>|&nbsp;|\s/ig,""))b="";if("function"===typeof k.config.ongetcontent)b=k.config.ongetcontent.call(k,b);else b=a.formatHTML(b)}else b=k._editorObj().value;return b};k._autoSave=function(d){var c=k._editorObj(),b=d?a.addListener:a.delListener;if(f)b(c,"beforedeactivate",k.save);else if("code"==k.currentMode())b(c,"blur",k.save);else b(c.contentWindow,"blur",k.save)};k.save=function(){k.obj.value=k.content()};k._intEdit=function(a){if(a.isIniEdit)return;a.isIniEdit=true;a.style.imeMode="disabled";a.onkeypress=function(){if(45==event.keyCode){this.value="-"==this.value.charAt(0)?this.value.substr(1):"-"+this.value;return false}return event.keyCode>=48&&event.keyCode<=57};a.onpaste=function(){return!clipboardData.getData("text").match(/\D/)};a.ondragenter=function(){return!/\D/.test(event.dataTransfer.getData("text"))};a.oldBlur=a.onblur;a.onblur=function(){if(""==this.value)return;this.value=parseInt(this.value,10);var a=this.getAttribute("max"),b=this.getAttribute("min");if(a!==j&&parseInt(this.value,10)>parseInt(a,10))this.value=parseInt(a,10);if(b!=j&&parseInt(this.value,10)<parseInt(b,10))this.value=parseInt(b,10);this.oldBlur&&this.oldBlur()}};if(g||f&&(b.documentMode==7||b.compatMode!="CSS1Compat")){var s=function(a){var b=null;while(a){if(a.tagName=="TABLE")b=a;a=a.parentNode}return b},v=s(b.scripts(b.scripts.length-1));if(v&&s(a.find(t))===v)e.setTimeout(k.init,20);else k.init()}else k.init()};a.url="./";a.version=v;if(a.url==="./"){var t=b.scripts||b.getElementsByTagName("SCRIPT"),o=t[t.length-1].getAttribute("src"),s=/[\?&]skin=([a-z0-9_A-Z]+)/.exec(o),k=e.location,u=k.protocol+"//"+k.host+(k.port?":"+k.port:"")+"/",S="";o=o.split("?")[0];a.url=o.substring(0,o.lastIndexOf("/"));if(""==a.url)a.url="./";else a.url+="/";if(a.url.indexOf(u)===0)a.url=a.url.substring(u.length-1,a.url.length);b.write('<link href="'+a.url+(s?"skin/"+s[1]+"/":"")+'TQEditor.css" id="TQEditorSkinCSS" rel="stylesheet" type="text/css" onload="TQE.checkSkin(this)" />');f&&b.compatMode!="CSS1Compat"&&b.write('<link href="'+a.url+'QuirksMode.css" id="TQEditorQuirksMode" rel="stylesheet" type="text/css" onload="TQE.checkSkin(this)" />')}a.config={paragraphs:[["\u6b63\u6587","p"],["\u6807\u98981","h1"],["\u6807\u98982","h2"],["\u6807\u98983","h3"],["\u6807\u98984","h4"],["\u6807\u98985","h5"],["\u6807\u98986","h6"],["\u9884\u5b9a\u4e49","pre"]],fontnames:[["\u5b8b\u4f53","\u5b8b\u4f53"],["\u65b0\u5b8b\u4f53","\u65b0\u5b8b\u4f53"],["\u4eff\u5b8b_GB2312","\u4eff\u5b8b_GB2312"],["\u9ed1\u4f53","\u9ed1\u4f53"],["\u5fae\u8f6f\u96c5\u9ed1","\u5fae\u8f6f\u96c5\u9ed1"],["\u6977\u4f53_GB2312","\u6977\u4f53_GB2312"],["Arial","arial, helvetica, sans-serif"],["Courier New","courier new, courier, mono"],["Georgia","Georgia, Times New Roman, Times, Serif"],["Tahoma","Tahoma, Arial, Helvetica, sans-serif"],["Times New Roman","times new roman, times, serif"]],fontsizes:[["\u7279\u5c0f","xx-small",1],["\u8f83\u5c0f","x-small",2],["\u5c0f","small",3],["\u4e2d","medium",4],["\u5927","large",5],["\u8f83\u5927","x-large",6],["\u7279\u5927","xx-large",7]],toolbar:"default",toolbarRight:[],advToolbar:["paragraph","fontname","fontsize","br","bold","italic","underline","strikethrough","forecolor","backcolor","removeformat","typeset","||","justifyleft","justifycenter","justifyright","justifynone",["superscript","subscript"],"br","orderedlist","unorderedlist","indent","outdent","||","inserthorizontalrule","splitpage","cleanword","br","createlink","unlink","inserttable","||","insertface","insertimage","insertmusic","insertflash","insertvideo"],advToolbarRight:["toolbarmode","br","fullscreen","mode","help"],advToolbarMode:false,showToolbarGroupHandle:true,tplFlash:'<embed  src="{$url}" width="{$width}" height="{$height}" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always"></embed>',tplFlv:'<embed src="'+a.url+'flvPlayer.swf" flashvars="vcastr_file={$url}&IsAutoPlay={$auto_start}" width="{$width}" height="{$height}" quality="high" bgcolor="#0E0E0E" name="play" align="middle" allowscriptaccess="sameDomain" allowfullscreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="opaque" />',tplRm:'<embed  src="{$url}" width={$width} height={$height} autostart="{$auto_start}"type="audio/x-pn-realaudio-plugin" console="Clip1" controls="ImageWindow" ></embed>',tplVideo:'<object classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"  type="application/x-ms-wmp" width="{$width}" height="{$height}"><PARAM NAME="URL" VALUE="{$url}" /><PARAM NAME="autoStart" VALUE="{$auto_start}" /><PARAM NAME="invokeURLs" VALUE="false"><PARAM NAME="playCount" VALUE="100"><PARAM NAME="Volume" VALUE="100"><PARAM NAME="defaultFrame" VALUE="datawindow"></object>',tplMusic:'<object id="tqeMP"  classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"  type="application/x-ms-wmp" width="230" height="64"><PARAM NAME="URL" VALUE="{$url}" /><PARAM NAME="autoStart" VALUE="{$auto_start}" /><PARAM NAME="invokeURLs" VALUE="false"><PARAM NAME="playCount" VALUE="100"><PARAM NAME="Volume" VALUE="100"><PARAM NAME="defaultFrame" VALUE="datawindow"></object>',tplSplitPage:'<h3 class="splitPage" name="split_page"></h3>',uploadFieldName:"file",imageUploadUrl:"",imageFileTypes:"*.jpg;*.gif;*.png;*.jpeg",imageFileSize:"2MB",directInsertUploadImage:false,linkUploadUrl:"",linkFileTypes:"*.*",linkFileSize:"2MB",flashUploadUrl:"",flashFileTypes:"*.swf",flashFileSize:"2MB",musicUploadUrl:"",musicFileTypes:"*.mp3;*.wma",musicFileSize:"2MB",videoUploadUrl:"",videoFileTypes:"*.flv;.mp4;*.mkv;*.wmv;*.asf;*.avi;*.rmvb;*.rm",videoFileSize:"2MB",enter2br:false,width:"auto",height:"auto",autoClean:true,faceCount:55,css:"",cssCode:"",bgColor:"",textColor:"",autoPopImagePanel:true,typesetImageTextCenter:true,typesetIndentParagraph:false,typesetImageBorder:true,baseHref:"",resize:true,onfocus:null,onblur:null,onkeydown:null,onkeyup:null,onpaste:null,oninit:null,ongetcontent:null,onsetcontent:null,debug:false};a.find=function(a){return b.getElementById(a)};a.CE=function(f,d,c,e){var a=b.createElement(f);if(d)a.id=d;if(c)a.innerHTML=c;e&&b.body.appendChild(a);return a};a.loadSkin=function(b){var c=a.find("TQEditorSkinCSS");c.href=a.url+(b&&"default"!=b?"skin/"+b+"/":"")+"TQEditor.css"};a.checkSkin=function(e){for(var d=b.styleSheets,f,c=d.length-1;c>=0;c--)if(d[c].href==e.href){f=d[c].cssRules||d[c].rules;if(f.length<1)e.href=a.url+"TQEditor.css";break}};a._doc=function(){return b.compatMode!="CSS1Compat"?b.body:b.documentElement};a._docST=function(){return e.scrollY?e.scrollY:a._doc().scrollTop};a._docSL=function(){return e.scrollX?e.scrollX:a._doc().scrollLeft};a.pos=function(b){var c=0,d=0,e=b.getBoundingClientRect(),f=a._doc();c=e.left+a._docSL()-f.clientLeft;d=e.top+a._docST()-f.clientTop;return{x:c,y:d,left:c,top:d,width:b.offsetWidth,height:b.offsetHeight}};a._hideContext=function(){if(a.activeContext){a.activeContext.style.display="none";a.activeContext=null}};a.pop=function(b,c){if(a.activePop==b){a.hidePop();return false}a._hideContext();a.hidePop();a.activePop=b;b.relateObj=c;c.className="eButtonDropDown";b.style.display="block";var e=a.pos(c),d=e.x,g=1+c.clientHeight+e.y,f=a._docSL(),h=a._doc().clientWidth;if(d+b.offsetWidth>f+h)d-=b.offsetWidth-c.offsetWidth;b.style.left=d+"px";b.style.top=g+"px";return true};a.hidePop=function(){if(!a.activePop)return;var b=a.activePop;a.activePop=null;b.style.display="none";if(b.relateObj&&b.relateObj.className=="eButtonDropDown")b.relateObj.className="eButton";b=a.find("ColorPicker");if(b)b.style.display="none"};a.delListener=function(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else a.detachEvent("on"+b,a["e"+b+c])};a.addListener=function(a,c,b){if(a.addEventListener)a.addEventListener(c,b,false);else{a["fn"+b]=b;a["e"+c+b]=function(c){a["fn"+b](c)};a.attachEvent("on"+c,a["e"+c+b])}};a._tags=function(a,b){return a.getElementsByTagName(b)};a.listenTags=function(f,g,d,e){for(var c=a._tags(f,g),b=c.length-1;b>=0;b--)a.addListener(c[b],d,e)};a._noSel=function(e,g){var h=function(){if(f){var a=event.srcElement.tagName;return"INPUT"==a||"TEXTAREA"==a}return false};if(g)for(var i=g.split(","),c,b,d=i.length-1;d>=0;d--){c=a._tags(e,i[d]);for(b=c.length-1;b>=0;b--){c[b].unselectable="on";c[b].onselectstart=h}}else{e.unselectable="on";e.onselectstart=h}};a._colorPickerUI=function(){var c=["00","33","66","99","CC","FF"],g=["FF0000","00FF00","0000FF","FFFF00","00FFFF","FF00FF"],h=191,a='<table width="'+h+'" cellpadding=0 ',d,b,e;a+=f?'cellspacing=1 border=0 bgcolor="#000000;">':'cellspacing=0 border=1 style="border-collapse:collapse;" >';for(d=0;d<2;d++)for(b=0;b<6;b++){a+="<tr height=10>";if(d>0)a+='<td bgcolor="#'+g[b]+'" name="'+name+'"></td>';else a+='<td bgcolor="#'+c[b]+c[b]+c[b]+'" ></td>';for(e=0;e<3;e++)for(k=0;k<6;k++)a+='<td bgcolor="#'+c[e+d*3]+c[k]+c[b]+'" ></td>';a+="</tr>"}a+='</table><div style="padding:2px 2px 1px 2px;line-height:25px;"><div style="height:25px;width:60px;display:block;float:left; margin-right:5px;" name=colorPreview></div><span name="colorValue" style="width:50px; display:inline-block;"></span><input type="button" value="'+J+'" /></div>';return a};a.pickColor=function(f,h,i){var c=a.find("ColorPicker");if(null==c){c=a.CE("DIV","ColorPicker",a._colorPickerUI(),true);c.className="ePopPanel";c.style.zIndex=99999999;c.onmouseover=function(){this.active=true};c.onmouseout=function(){this.active=false};a._noSel(c);a.listenTags(c,"TD","mouseover",function(){var a=this,b=this.parentNode.parentNode.parentNode.parentNode.lastChild,c=e.setInterval(function(){a.style.backgroundColor=a.style.backgroundColor!=""?"":"#FFFFFF"},500);b.firstChild.style.backgroundColor=this.bgColor;b.firstChild.nextSibling.innerHTML=this.bgColor;a.style.backgroundColor="#FFFFFF";a.onmouseout=function(){e.clearInterval(c);this.style.backgroundColor=""}});c.lastChild.lastChild.onclick=function(){this.parentNode.parentNode.style.display="none"};a.listenTags(c,"TD","mouseup",function(){this.parentNode.parentNode.parentNode.parentNode.style.display="none"});a.addListener(b,"mousedown",function(){var b=a.find("ColorPicker");if(!b.active)b.style.display="none"})}for(var g=a._tags(c,"TD"),d=g.length-1;d>=0;d--)g[d].onmousedown=function(a){f(this.bgColor);a=a||event;a.cancelBubble=true};c.lastChild.lastChild.onclick=function(a){f("");a=a||event;a.cancelBubble=true};c.style.left=h+"px";c.style.top=i+"px";c.style.display="block"};a.drag=function(c){c.style.position="absolute";c.dragging=false;c.onmousedown=function(d){var j,k,h,g,i=a.pos(this),l=a._docSL(),m=a._docST(),n=b.onmousemove,o=b.onmouseup;if(f){d=e.event;h=d.srcElement;j=l+d.clientX-i.x;k=m+d.clientY-i.y}else{h=d.target;j=d.pageX-i.x;k=d.pageY-i.y}if(c.dragging)return;c.dragging=true;g=h.tagName;if(h!=this&&(g=="INPUT"||g=="TEXTAREA"||g=="BUTTON"||g=="SELECT"))return;if(c.setCapture)c.setCapture();else e.captureEvents&&e.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);b.onmousemove=function(a){if(f){a=e.event;a.pageX=l+a.clientX;a.pageY=m+a.clientY}var b=a.pageX-j,d=a.pageY-k;c.style.left=b+"px";c.style.top=d+"px";c.style.cursor="move"};b.onmouseup=function(){if(c.releaseCapture)c.releaseCapture();else e.releaseEvents&&e.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);b.onmousemove=n;b.onmouseup=o;c.style.cursor="";c.dragging=false}}};a.clone=function(b){if(typeof b!="object")return b;if(b==null)return b;var c,d="[object Array]"==Object.prototype.toString.call(b)?[]:{};for(c in b)d[c]=a.clone(b[c]);return d};a.removeNode=function(a,b){if(a.removeNode)return a.removeNode(b);if(b)return a.parentNode.removeChild(a);while(a.firstChild)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a)};a.formatHTML=function(a){return a.replace(/\s*<(p|table|tr|hr|div|object|ol|li|ul|h[1-6])(?![a-z])/ig,"\n<$1").replace(/<\/(p|table|div|object|ol|ul|h[1-6])>\s*/ig,"</$1>\n").replace(/(<(?:br|hr)(?![a-z0-9])[^>]*>)\s*/ig,"$1\n").replace(/^\s*/,"").replace(/\s*$/,"")};a.toolbarMode={admin:{left:["paragraph","fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","justifyleft","justifycenter","orderedlist","unorderedlist",["justifyright","|","indent","outdent","|","superscript","subscript"],"||","createlink","insertimage","inserttable",["splitpage","inserthorizontalrule"],"|","insertmusic","insertflash","insertvideo","||","cleanword","typeset"],right:["toolbarmode","fullscreen","|","help"]},bbs:{left:["fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","justifyleft","justifycenter","justifyright","||","createlink","insertimage","|","insertface","insertmusic","insertflash","insertvideo","|","typeset"],right:["toolbarmode","fullscreen","|","help"]},user:{left:["fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","justifyleft","justifycenter","orderedlist",["justifyright","unorderedlist","|","indent","outdent","|","inserthorizontalrule"],"||","createlink","insertimage","insertvideo","|","typeset"],right:["toolbarmode","fullscreen","|","help"]},mini:{left:["fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","align","|","createlink","insertimage"],right:["help"]},message:{left:["insertface","|","bold","italic","underline","forecolor","removeformat"],right:["help"]},full:{left:["paragraph","fontname","fontsize","|","bold","italic","underline","strikethrough","forecolor","backcolor","removeformat","||","align","list","iodent",["superscript","subscript"],"||","createlink","unlink","insertimage","inserttable","inserthorizontalrule","splitpage","insertface","|","insertmusic","insertflash","insertvideo","||","cleanword","typeset"],right:["toolbarmode","fullscreen","mode","|","help"]},normal:{left:["paragraph","fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","||","justifyleft","justifycenter","orderedlist","unorderedlist","||","createlink","insertimage","inserttable","|","insertvideo","|","typeset"],right:["toolbarmode","fullscreen","|","help"]}};a.toolbarBottons={paragraph:{text:"\u6bb5\u843d",click:function(d,j){var c=a.find(d.objId+"Paragraph"),b;if(null==c){var i="",e=d.config.paragraphs;for(b=0;b<e.length;b++)i+='<div name="FormatBlock" class="eMenuItem" unselectable=on onselectstart="return false" paraValue="'+e[b][1]+'">'+e[b][0]+"</div>";c=a.CE("DIV",d.objId+"Paragraph",i,true);c.className="ePopPanel";a._noSel(c);a.listenTags(c,"DIV","click",function(){a.hidePop();var b=this.getAttribute("paraValue");if(f)b="<"+b+">";d.exeCmd("FormatBlock",b)});if(g){var h=a._tags(c,"DIV");for(b=h.length-1;b>=0;b--)d._ieMouseStyle(h[b],"eMenuItem","eMenuItemUp","eMenuItem")}}a.pop(c,j)}},fontsize:{text:"\u6587\u5b57\u5927\u5c0f",click:function(d,i){var c=a.find(d.objId+"FontSize");if(null==c){for(var h="",f,e=d.config.fontsizes,b=0;b<e.length;b++)h+='<div name="FontSize" class="eMenuItem" unselectable=on onselectstart="return false" paraValue="'+e[b][2]+'" style="font-size:'+e[b][1]+';" >'+e[b][0]+"</div>";c=a.CE("DIV",d.objId+"FontSize",h,true);c.className="ePopPanel";a._noSel(c);a.listenTags(c,"DIV","click",function(){a.hidePop();d.exeCmd("FontSize",this.getAttribute("paraValue"))});if(g){f=a._tags(c,"DIV");for(b=f.length-1;b>=0;b--)d._ieMouseStyle(f[b],"eMenuItem","eMenuItemUp","eMenuItem")}}a.pop(c,i)}},fontname:{text:"\u5b57\u4f53",click:function(d,i){var c=a.find(d.objId+"FontName");if(null==c){for(var f,h="",e=d.config.fontnames,b=0;b<e.length;b++)h+='<div name="FontName" class="eMenuItem" unselectable=on onselectstart="return false"  paraValue="'+e[b][1]+'"  style="font-family:'+e[b][1]+';" >'+e[b][0]+"</div>";c=a.CE("DIV",d.objId+"FontName",h,true);c.className="ePopPanel";a._noSel(c);a.listenTags(c,"DIV","click",function(){a.hidePop();d.exeCmd("FontName",this.getAttribute("paraValue"))});if(g){f=a._tags(c,"DIV");for(b=f.length-1;b>=0;b--)d._ieMouseStyle(f[b],"eMenuItem","eMenuItemUp","eMenuItem")}}a.pop(c,i)}},forecolor:{text:"\u6587\u672c\u989c\u8272",click:function(b,a){b._showColorSelectUI(a,"forecolor")}},backcolor:{text:"\u80cc\u666f\u8272",click:function(b,a){b._showColorSelectUI(a,f?"backcolor":"hilitecolor")}},bold:{text:"\u7c97\u4f53",click:null},italic:{text:"\u659c\u4f53",click:null},underline:{text:"\u4e0b\u5212\u7ebf",click:null},strikethrough:{text:"\u5220\u9664\u7ebf",click:null},removeformat:{text:"\u6d88\u9664\u683c\u5f0f",click:function(e){a.hidePop();e.exeCmd("removeformat");if(l||m)return;var g=e._getRange(),f=function(a){return a.replace(/<\/?span[^>]*>/ig,"").replace(/<p [^>]*>/ig,"<p>").replace(/<div [^>]*>/ig,"<div>")},h="",d=g.htmlText,c,b;if(d)e.insertHtml(f(d));else{c=g.cloneContents().childNodes;for(b=0;b<c.length;b++)if("#comment"!=c[b].nodeName){d=c[b].outerHTML||c[b].nodeValue;if(d)h+=d}e.insertHtml(f(h))}}},submenu:{text:"",click:function(b,a){b._popAsMenu(a,a.getAttribute("submenu").split(","))}},subscript:{text:"\u4e0b\u6807",click:null},superscript:{text:"\u4e0a\u6807",click:null},align:{text:"\u5bf9\u9f50",click:function(b,a){b._popAsMenu(a,["justifyleft","justifycenter","justifyright"])}},justifyleft:{text:"\u5de6\u5bf9\u9f50",click:null},justifycenter:{text:"\u5c45\u4e2d\u5bf9\u9f50",click:null},justifyright:{text:"\u53f3\u5bf9\u9f50",click:null},justifyfull:{text:"\u4e24\u7aef\u5bf9\u9f50",click:null},justifynone:{text:"\u53d6\u6d88\u5bf9\u9f50",click:null},list:{text:"\u5217\u8868",click:function(b,a){b._popAsMenu(a,["orderedlist","unorderedlist"])}},unorderedlist:{text:"\u9879\u76ee\u5217\u8868",click:function(b){a.hidePop();b.exeCmd("InsertUnorderedList")}},orderedlist:{text:"\u6570\u76ee\u5217\u8868",click:function(b){a.hidePop();b.exeCmd("InsertOrderedList")}},iodent:{text:"\u7f29\u8fdb\u65b9\u5411",click:function(b,a){b._popAsMenu(a,["indent","outdent"])}},outdent:{text:"\u51cf\u5c11\u7f29\u8fdb",click:null},indent:{text:"\u589e\u52a0\u7f29\u8fdb",click:null},inserthorizontalrule:{text:"\u63d2\u5165\u6c34\u5e73\u7ebf",click:null},createlink:{text:"\u6dfb\u52a0\u94fe\u63a5",click:function(b,h){var d=a.find(b.objId+"CreateLink");if(null==d){var g=function(){a.hidePop();var g=this.form.elements,f=g.url.value,d=g.target.value,e=g.title.value,h="";if("http://"==f||""==f){b.exeCmd("Unlink");return false}var i=b._getRange();if(n&&i.collapsed||!b.exeCmd("CreateLink",f)){if(d!=="")d=' target="'+d+'" ';if(e!=="")h=' title="'+e+'" ';b.insertHtml('<a href="'+f+'" '+h+d+">"+(e?e:f)+"</a>");return false}var c=b.focusNode();do if(c.tagName=="A"){if(""==d)c.removeAttribute("target");else c.setAttribute("target",d);if(""==e)c.removeAttribute("title");else c.setAttribute("title",e);break}while(c=c.parentNode);return false};d=b._popFormUI(b.objId+"CreateLink",I,C,g,null,b.config.linkUploadUrl,b.config.linkFileTypes,b.config.linkFileSize,"link");a.drag(d)}if(!a.pop(d,h))return;var f=a._tags(d,"FORM")[0],e=f.elements,c=b.focusNode();f.reset();do if(c.tagName=="A"){e.url.value=c.getAttribute("href");e.title.value=c.getAttribute("title");b.__selectOption(e.target,c.getAttribute("target"));break}while(c=c.parentNode);e.url.focus()}},unlink:{text:"\u5220\u9664\u94fe\u63a5",click:null},insertimage:{text:"\u63d2\u5165\u56fe\u7247",click:function(d,i){var f=a.find(d.objId+"InsertImage");if(null==f){var h=function(){a.hidePop();var b=this.form.elements;d.insertImage(b.url.value,b.width.value,b.height.value,b.border.value,b.alt.value,b.align.value);return false};f=d._popFormUI(d.objId+"InsertImage",F,z,h,["width","height","border"],d.config.imageUploadUrl,d.config.imageFileTypes,d.config.imageFileSize,"image");a.drag(f)}if(!a.pop(f,i))return;var g=a._tags(f,"FORM")[0],e=g.elements,b=d._getRange(),c=b.commonAncestorContainer;g.reset();if(c){if(!b.collapsed&&b.startContainer==b.endContainer&&b.startOffset-b.endOffset<2&&b.startContainer.hasChildNodes())c=b.startContainer.childNodes[b.startOffset];if(c.tagName!="IMG"&&w&&""===b.toString())if(j===b.startContainer.length&&b.startContainer.firstChild===b.endContainer.previousSibling)c=b.startContainer.firstChild;else if(b.endContainer.lastChild===b.startContainer.nextSibling)c=b.endContainer.lastChild;else if(b.startContainer.length==b.startOffset&&b.endOffset==0&&b.startContainer.nextSibling==b.endContainer.previousSibling)c=b.startContainer.nextSibling;if(!c||c.tagName!="IMG")c=null}else if(b.length&&b.item(0).tagName=="IMG")c=b.item(0);if(c&&"IMG"==c.nodeName){e.url.value=c.getAttribute("src");e.width.value=c.width;e.height.value=c.height;e.border.value=c.border;e.alt.value=c.alt;d.__selectOption(e.align,c.align)}e.url.focus()}},insertface:{text:"\u8868\u60c5",click:function(d,h){var c=a.find(d.objId+"InsertFace");if(null==c){for(var e,f='<div class="eFace">',b=1;b<=d.config.faceCount;b++)f+='<img src="'+a.url+"face/"+b+'.gif" emot="'+b+'" />';f+="</div>";c=a.CE("DIV",d.objId+"InsertFace",f,true);c.className="ePopPanel";a._noSel(c);a.listenTags(c,"IMG","click",function(){a.hidePop();d.insertHtml('<img align=absMiddle src="'+this.getAttribute("src")+'" emot="'+this.getAttribute("emot")+'" />')});if(g){e=a._tags(c,"IMG");for(b=e.length-1;b>=0;b--)d._ieMouseStyle(e[b],"","imgHover","")}}a.pop(c,h)}},insertflash:{text:"\u63d2\u5165Flash",click:function(b,f){var c=a.find(b.objId+"InsertFlash"),d;if(null==c){var e=function(){a.hidePop();var c=this.form.elements;b.insertFlash(c.url.value,c.width.value,c.height.value);return false};c=b._popFormUI(b.objId+"InsertFlash",E,y,e,["width","height"],b.config.flashUploadUrl,b.config.flashFileTypes,b.config.flashFileSize,"flash");a.drag(c)}if(!a.pop(c,f))return;d=a._tags(c,"FORM")[0];d.reset();d.elements.url.focus()}},insertmusic:{text:"\u63d2\u5165\u97f3\u9891",click:function(b,f){var c=a.find(b.objId+"InsertMusic"),d;if(null==c){var e=function(){a.hidePop();var c=this.form.elements;b.insertMusic(c.url.value,c.auto_start.value);return false};c=b._popFormUI(b.objId+"InsertMusic",G,A,e,null,b.config.musicUploadUrl,b.config.musicFileTypes,b.config.musicFileSize,"music");a.drag(c)}if(!a.pop(c,f))return;d=a._tags(c,"FORM")[0];d.reset();d.elements.url.focus()}},insertvideo:{text:"\u63d2\u5165\u89c6\u9891",click:function(b,f){var c=a.find(b.objId+"InsertVideo"),d;if(null==c){var e=function(){a.hidePop();var c=this.form.elements;b.insertVideo(c.url.value,c.auto_start.value,c.width.value,c.height.value,c.video_type.value);return false};c=b._popFormUI(b.objId+"InsertVideo",H,B,e,["width","height"],b.config.videoUploadUrl,b.config.videoFileTypes,b.config.videoFileSize,"video");a.drag(c)}if(!a.pop(c,f))return;d=a._tags(c,"FORM")[0];d.reset();d.elements.url.focus()}},cleanword:{text:"\u6e05\u7406Word\u4ee3\u7801",click:function(b){a.hidePop();b.cleanWord(true)}},typeset:{text:"\u81ea\u52a8\u6392\u7248",click:function(b){a.hidePop();b.typeset()}},mode:{text:"\u67e5\u770b\u6e90\u7801",click:function(b){a.hidePop();b.changeMode()}},splitpage:{text:"\u63d2\u5165\u5206\u9875\u7b26",click:function(b){a.hidePop();b.insertHtml(b.config.tplSplitPage)}},group:{text:"",click:null},br:{text:"",click:null},separator:{text:"",click:null},fullscreen:{text:"\u5168\u5c4f",click:function(b){a.hidePop();b.fullScreen()}},toolbarmode:{text:"\u5de5\u5177\u680f\u6a21\u5f0f",click:function(b){a.hidePop();b.changeToolbarMode()}},help:{text:"\u5e2e\u52a9",click:function(c,d){var b=a.find(c.objId+"TQHelpPanel");if(null==b){b=a.CE("DIV",c.objId+"TQHelpPanel",'<form class="ePopForm" style="line-height:20px;">TQEditor<br/>'+K+": "+v+"<br/>"+O+': <a href="http://www.e512.net" target="_blank">e512.net</a><br />'+N+': <a href="mailto:litqqs@163.com">litqqs@163.com</a><br /></form>',true);b.className="ePopPanel"}a.pop(b,d)}}};e.tqEditor=e.tqeditor=e.TQEditor=e.TQE=a;e.isIE=f;e.isIE6=g;e.isIE9=w;e.isWebkit=n;e.isOpera=m;e.isGecko=l})(window); 
(function(a){if(!a){throw"\u5fc5\u987b\u5148\u52a0\u8f7d TQEditor.js ";return}var b=a.prototype;b.images=function(e){var d=this,c=[],g="",f=d._getDoc(),b,a;if("code"===d.currentMode())return c;b=f.getElementsByTagName("IMG");for(a=0;a<b.length;a++)c.push(e?b[a].src:b[a].getAttribute("src"));return c};b.flashs=function(){var d=this,c=[],f="",e=d._getDoc(),b,a;if("code"===d.currentMode())return c;b=e.getElementsByTagName("EMBED");for(a=0;a<b.length;a++){if(b[a].getAttribute("type").toLowerCase().indexOf("shockwave-flash")<0||b[a].getAttribute("flashvars").toLowerCase().indexOf(".flv"))continue;c.push(full_uri?b[a].src:b[a].getAttribute("src"))}return c};b.flvs=function(){var d=this,c=[],f="",e=d._getDoc(),b,a;if("code"===d.currentMode())return c;b=e.getElementsByTagName("EMBED");for(a=0;a<b.length;a++){if(b[a].getAttribute("flashvars").toLowerCase().indexOf("vcastr_file")<0)continue;/vcastr_file=([^\"& ]+)/i.exec(b[a].getAttribute("flashvars"));RegExp.$1&&c.push(RegExp.$1)}return c};b.removeLinks=function(d){var e=this,g=e._getDoc(),c,b,f;if("code"===e.currentMode())return;c=g.getElementsByTagName("A");if("function"===typeof d)for(b=c.length-1;b>=0;b--){f=d(c[b].getAttribute("href"));f&&a.removeNode(c[b],false)}else for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false);return};b.removeImages=function(d){var e=this,g=e._getDoc(),c,b,f;if("code"===e.currentMode())return;c=g.getElementsByTagName("IMG");if("function"===typeof d)for(b=c.length-1;b>=0;b--){f=d(c[b].getAttribute("src"));f&&a.removeNode(c[b],false)}else for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false);return};b.removeFlashs=function(d){var e=this,g=e._getDoc(),c,b,f;if("code"===e.currentMode())return;c=g.getElementsByTagName("EMBED");if("function"===typeof d)for(b=c.length-1;b>=0;b--){f=d(c[b].getAttribute("src"));f&&a.removeNode(c[b],false)}else for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false);return};b.removeObjects=function(){var d=this,e=d._getDoc(),c,b,f;if("code"===d.currentMode())return;c=e.getElementsByTagName("OBJECT");for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false)};b.getSelectText=function(b){var c=this,a=c.getSelectHtml();if(b)a=a.replace(/<(br|p|div|ul|ol|li|tr)[^>]*>\n?/g,"\n");return a.replace(/<(textarea|select|script|style)[^>]*>.*?<\/\1>/ig,"").replace(/<\/?[a-z][^>]*>/ig,"").replace(/\n+/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ")};b.getSelectHtml=function(){var d=this;if("code"==d.currentMode()){var f=d._editorObj();if(document.selection){var k=document.selection.createRange();return k.text}return f.selectionStart!=f.selectionEnd?f.value.substring(f.selectionStart,f.selectionEnd):""}if(d.activeTable){var c,b,e,g=a.CE("DIV");g.innerHTML=d.activeTable.outerHTML;c=g.firstChild;for(b=c.rows.length-1;b>=0;b--){for(e=c.rows[b].cells.length-1;e>=0;e--)if(c.rows[b].cells[e].className=="selectedTD")c.rows[b].cells[e].className="";else c.rows[b].removeChild(c.rows[b].cells[e]);c.rows[b].cells.length<1&&c.rows[b].parentNode.removeChild(c.rows[b])}return g.innerHTML}d.focus();var i=d._getRange(),j=i.htmlText;if(j)return j;else{var g=a.CE("DIV"),h=i.cloneContents().childNodes;while(h.length)g.appendChild(h[0]);return g.innerHTML}}})(window.TQE); 
function ubb2html(g){var c=0,f=[],a=""+g,b="",e="http://www.qs.com/vt/inc/client/js/tqEditor/",d=function(a){return a.replace(/\[\]/g,function(a){return({"[":"%5b","]":"%5d"})[a]})};a=a.replace(/[<>\" ]/g,function(a){return({"<":"&lt;",">":"&gt;",'"':"&quot;"," ":"&nbsp;"})[a]}).replace(/\r?\n/g,"<br>");do b="__CODE__"+Math.random()+"_";while(a.indexOf(b)>=0);a=a.replace(/\[code[=\]].*?\[\/code\]/ig,function(a){f.push(a);return b+c+++"_"}).replace(/\[flv(?:\s*=\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?)?\](.*?)\[\/flv\]/ig,function(g,b,a,c,f){if(!b)b=320;if(!a)a=240;return'<embed id="flvPlayer" src="'+e+'flvPlayer.swf" flashvars="vcastr_file='+d(f)+"&IsAutoPlay="+c+'" width="'+b+'" height="'+a+'" quality="high" bgcolor="#0E0E0E" name="play" align="middle" allowscriptaccess="sameDomain" allowfullscreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="opaque" />'}).replace(/\[rm(?:\s*=\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?)?\](.*?)\[\/rm\]/ig,function(f,b,a,c,e){if(!b)b=320;if(!a)a=240;return'<embed src="'+d(e)+'" width='+b+" height="+a+' autostart="'+c+'}" type="audio/x-pn-realaudio-plugin" console="Clip1" controls="ImageWindow" ></embed>'}).replace(/\[mp3\](.*?)\[\/mp3\]/ig,'<object id="mp3Player"  classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"  type="application/x-ms-wmp" width="230" height="64"><PARAM NAME="URL" VALUE="$1" /><PARAM NAME="autoStart" VALUE="0" /><PARAM NAME="invokeURLs" VALUE="false"><PARAM NAME="playCount" VALUE="100"><PARAM NAME="Volume" VALUE="100"><PARAM NAME="defaultFrame" VALUE="datawindow"></object>').replace(/\[img\](.*?)\[\/img\]/ig,"<img src=$1 />").replace(/\[img(?:=\s*(\d+)\s*,\s*(\d+)\s*)\]\s*([\w_\-\.\/:]*)\s*\[\/img\]/ig,"<img src=$3 width=$1  height=$2 />").replace(/\[(color|size)\s*=\s*([^\]]+)\s*\]/ig,"<font $1=$2>").replace(/\[\/(color|size)\]/ig,"</font>").replace(/\[bg\s*=\s*([^\]]+)\s*\]/ig,'<span style="background:$1">').replace(/\[\/bg]/ig,"</span>").replace(/\[(left|center|right)]/ig,'<div style="text-align:$1">').replace(/\[\/(left|center|right)]/ig,"</div>").replace(/(?:<br>|\s)?\[list\](.*?)(<br>|\s)*\[\/list\]/ig,function(b,a){return"<ul>"+a.replace(/\<br\>(\s|&nbsp;)*\[\*\]/g,"<li>")+"</ul>"}).replace(/(?:<br>|\s)?\[numlist\](.*?)(<br>|\s)*\[\/numlist\]/ig,function(b,a){return"<ol>"+a.replace(/\<br\>(\s|&nbsp;)*\[\*\]/g,"<li>")+"</ol>"}).replace(/\[\:(\d+)]/g,'<img src="'+e+'face/$1.gif" emot="$1" align="absMiddle"  >').replace(/\[(\/?(?:b|u|i|s|sup|sub|h[1-6]))\]/ig,"<$1>").replace(/\[url\]\s*(((?!")[\s\S])*?)(?:"[\s\S]*?)?\s*\[\/url\]/ig,'<a href="$1">$1</a>').replace(/\[url\s*=\s*([^\]"]+?)(?:"[^\]]*?)?\s*\]\s*([\s\S]*?)\s*\[\/url\]/ig,'<a href="$1">$2</a>').replace(/\[email\]\s*(((?!")[\s\S])+?)(?:"[\s\S]*?)?\s*\[\/email\]/ig,'<a href="mailto:$1">$1</a>').replace(/\[email\s*=\s*([^\]"]+?)(?:"[^\]]*?)?\s*\]\s*([\s\S]+?)\s*\[\/email\]/ig,'<a href="mailto:$1">$2</a>').replace(/\[qq\]\s*(\d+)\s*\[\/qq\]/ig,'<a href="tencent://message/?uin=$1">$1</a>').replace(/\[qq\s*=\s*(\d+)\s*\]\s*([\s\S]+?)\s*\[\/qq\]/ig,'<a href="tencent://message/?uin=$1">$2</a>').replace(/\[quote\]([\s\S]*?)\[\/quote\]/ig,"<blockquote>$1</blockquote>");while(/\[table\](((?!\[table)[\s\S])+?)\[\/table\]/i.test(a))a=a.replace(/\[table\](((?!\[table)[\s\S])+?)\[\/table\]/ig,function(b,a){return'<table style="border-collapse: collapse;" width=98% border="1" cellPadding="3">'+a.replace(/\[(\/?(?:tr|td|th))\]/ig,"<$1>")+"</table>"});c=-1;a=a.replace(new RegExp(b+"\\d+_","g"),function(){return f[++c]});return a}function html2ubb(h){var e=0,g=[],a=""+h,d="";do d="__CODE__"+Math.random()+"_";while(a.indexOf(d)>=0);a=a.replace(/[\r\n]/g,"").replace(/<br[^>]*>/ig,"\n");a=a.replace(/\[code[=\]].*?\[\/code\]/ig,function(a){g.push(a);return d+e+++"_"}).replace(/<embed ([^>]*)>/ig,function(h,f){var a,d,c="",e="",g="",b=f.toLowerCase();a=/width\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)c="="+a[1];if(c!=""){a=/height\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)e=","+a[1]}if(b.indexOf("vcastr_file")){a=/vcastr_file=([^\"&]+)/.exec(f);d=a[1];if(""!=c){a=/IsAutoPlay=(0|1)/.exec(f);if(a)g=","+a[1]}return"[flv"+c+e+g+"]"+d+"[/flv]"}if(b.indexOf("shockwave-flash")){a=/src\s*=\s*\"?([^ \"]+)/i.exec(b);d=a[1];return"[flash"+c+e+"]"+d+"[/flash]"}if(b.indexOf("realaudio-plugin")){a=/src\s*=\s*\"?([^ \"]+)/i.exec(b);d=a[1];if(""!=c){a=/autostart\s*=\s*\"?(0|1)/.exec(b);if(a)g=","+a[1]}return"[rm"+c+e+"]"+d+"[/rm]"}return""}).replace(/<object (.*?)<\/object>/ig,function(f,c){var a,d,e="",g="",h="",b=c.toLowerCase();a=/width\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)e="="+a[1];if(e!=""){a=/height\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)g=","+a[1]}a=/<PARAM\s+NAME\s*=\s*"?URL"?\s+VALUE\s*=\s*"?([^\"> ]+)"?/i.exec(c);d=a[1];return b.indexOf("mp3player")?"[mp3]"+d+"[/mp3]":f}).replace(/<img ([^>]+)>/ig,function(g,b){var a,e,c="",f="",h="",d=b.toLowerCase();a=/width\s*=\s*\"?([^ \"]+)/i.exec(d);if(a)c="="+a[1];if(c!=""){a=/height\s*=\s*\"?([^ \"]+)/i.exec(d);if(a)f=","+a[1]}a=/emot\s*=\s*"?(\d+)"?/i.exec(b);if(a)return"[:"+a[1]+"]";a=/src\s*=\s*"?([^\"> ]+)"?/i.exec(b);e=a[1];return"[img"+c+f+"]"+e+"[/img]"}).replace(/<ul[^>]*>/ig,"\n[list]").replace(/\s*<\/ul[^>]*>/ig,"\n[/list]").replace(/<ol[^>]*>/ig,"\n[numlist]").replace(/\s*<\/ol[^>]*>/ig,"\n[/numlist]").replace(/\s*<li[^>]*>/ig,"\n[*]").replace(/<\/li[^>]*>/ig,"").replace(/<(\/?(?:b|u|i|s|sup|sub|table|tr|td|th|h[1-6]))(?![a-z])[^>]*>/ig,"[$1]").replace(/<(\/)?(strong|em|strike|del)(?![a-z])[^>]*>/ig,function(d,a,b){var c=({strong:"b",em:"i",strike:"s",del:"s"})[b.toLowerCase()];if(a!=="/")a="";return"["+a+c+"]"}).replace(/<blockquote(?:\s+[^>]*?)?>([\s\S]+?)<\/blockquote>/ig,"[quote]$1[/quote]");var i,b,f=function(e,c,b){var a=(e*65536+c*256+b*1).toString(16),d=a.length;while(d++<6)a="0"+a;return"#"+a},c=function(b){var c="",a="";b=b.toLowerCase();if(/align\s*[=:]\s*\"?(left|center|right)/.exec(b)){c+="["+RegExp.$1+"]";a="[/"+RegExp.$1+"]"+a}if(/[^-]size\s*=\s*\"?(\d+\s*(?:px|pc|pt|em|ex|cm|mm)?)/.exec(b)){c+="[size="+RegExp.$1+"]";a="[/size]"+a}if(/[^-]color\s*[:=]\s*\"?rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(b)){c+="[color="+f(RegExp.$1,RegExp.$2,RegExp.$3)+"]";a="[/color]"+a}else if(/[^-]color\s*[:=]\s*\"?([a-z0-9#]+)/.exec(b)){c+="[color="+RegExp.$1+"]";a="[/color]"+a}if(/background(?:\-color)?\s*:\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(b)){c+="[bg="+f(RegExp.$1,RegExp.$2,RegExp.$3)+"]";a="[/bg]"+a}else if(/background(?:\-color)?\s*:\s*([a-z0-9#]+)/.exec(b)){c+="[bg="+RegExp.$1+"]";a="[/bg]"+a}return{pre:c,end:a}};while(/<div([^>]*)>(((?!<div)[\s\S])*?)<\/div>/i.test(a))a=a.replace(/<div([^>]*)>(((?!<div)[\s\S])*?)<\/div>/ig,function(e,a,d){b=c(a);return"\n"+b.pre+d+b.end+"\n"});while(/<p([^>]*)>(((?!<p)[\s\S])*?)<\/p>/i.test(a))a=a.replace(/<p([^>]*)>(((?!<p)[\s\S])*?)<\/p>/ig,function(e,a,d){b=c(a);return"\n"+b.pre+d+b.end+"\n"});while(/<span([^>]*)>(((?!<span)[\s\S])*?)<\/span>/i.test(a))a=a.replace(/<span([^>]*)>(((?!<span)[\s\S])*?)<\/span>/ig,function(e,a,d){b=c(a);return b.pre+d+b.end});while(/<font([^>]*)>(((?!<font)[\s\S])*?)<\/font>/i.test(a))a=a.replace(/<font([^>]*)>(((?!<font)[\s\S])*?)<\/font>/ig,function(e,a,d){b=c(a);return b.pre+d+b.end});e=-1;a=a.replace(/<a .*?href\s*=\s*["']?([^'" ]+)[^>]*>([\s\S]*?)<\/a>/ig,function(e,a,c){var b="url";if("mailto:"==a.substr(0,7).toLowerCase()){b="email";a=a.substr(7,a.length)}else if("tencent:"==a.substr(0,8)){b="qq";var d=/uin=(\d+)/i.exec(a);a=d[1]}return c==a?"["+b+"]"+c+"[/"+b+"]":"["+b+"="+a+"]"+c+"[/"+b+"]"}).replace(/<\/?[a-z][^>]*>/ig,"").replace(new RegExp(d+"\\d+_","g"),function(){return g[++e]}).replace(/(&nbsp;|&gt;|&lt;|&quot;)/g,function(a){return({"&nbsp;":" ","&gt;":">","&lt;":"<","&quot;":'"'})[a]}).replace(/\n\s*\n/g,"\n\n");return a}TQE.formatHTML=function(m){var d=m.replace(/<(strong|b|u|i|em|span|font)[^>]*><\/\1>/ig,""),a="",l=new RegExp("\\s*(<(\\/?)([a-z]\\w*)[^>]*>)[\\r\\n]*","im"),c=[],h={table:1,tbody:1,thead:1,tfoot:1,tr:1,td:1,p:1,caption:1,div:1,object:1,param:1,embed:1,dl:1,dd:1,dt:1,ul:1,ol:1,li:1,hr:1,script:1},f={table:1,tbody:1,thead:1,tfoot:1,tr:1,object:1,dl:1,ul:1,ol:1,div:1,script:1},i={a:1,u:1,i:1,b:1,strong:1,em:1,font:1,span:1,img:1,input:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},k,g,e,j,b;while(null!=(result=l.exec(d))){k=d.substr(0,result.index);g=result[0];e=result[1];j="/"===result[2];b=result[3].toLowerCase();d=d.substr(result.index+g.length);a+=k;if(j){f[b]&&c.pop();if(i[b])a+=g;else if(f[b])a+="\n"+c.join("")+e;else a+=e;if(h[b])a+="\n"}else{if(h[b])a+="\n";if(i[b])a+=g;else if(f[b])a+=c.join("")+e+"\n";else a+=c.join("")+e;if("hr"===b||"br"===b)a+="\n";f[b]&&c.push("  ")}}a+=d;a=a.replace(/\n+/g,"\n").replace(/^[ \n\r\t]+/g,"").replace(/[ \n\r\t]+$/g,"").replace(/<td([^>]*)>\s+<br/ig,"<td$1 ><br").replace(/<br>\s+<\/td>/ig,"<br></td>");if("<p>&nbsp;</p>"===a||"<br>"===a)a="";return a}